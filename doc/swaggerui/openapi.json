{
    "openapi": "3.0.0",
    "info": {
        "version": "alpha",
        "title": "norderney API",
        "description": "This is the definition of the norderney API. Essentially it is a work in progress, so things are bound to change a lot. The specification for OpenAPI can be found [here](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md)",
        "license": {
            "name": "GPLv3"
        },
        "contact": {
            "name": "Matthias Plock",
            "email": "matthias.plock@bam.de",
            "url": "http://www.github.com/klump3n/norderney"
        }
    },

    "servers": [
        {
            "url": "{protocol}://{host_ip}:{port}/api",
            "description": "The URL to the API service.",
            "variables": {
                "protocol": {
                    "description": "HTTP or HTTPS",
                    "enum": [
                        "https",
                        "http"
                    ],
                    "default": "http"
                },
                "host_ip": {
                    "description": "The IP of the server.",
                    "enum": [
                        "141.63.178.52",
                        "10.8.0.6"
                    ],
                    "default": "141.63.178.52"
                },
                "port": {
                    "description": "The port of the server.",
                    "enum": [
                        "8008"
                    ],
                    "default": "8008"
                }
            }
        }
    ],
    "paths": {

        "/": {
            "options": {
                "summary": "Return the API?",
                "description": "Check this...",
                "tags": [
                    "verify"
                ]
            }
        },

        "/version": {
            "get": {
                "summary": "Returns program name and version.",
                "description": "Returns the program name and version of the server, so the client can determine if he is compatible.",
                "tags": [
                    ""
                ],
                "externalDocs": {
                    "description": "Link to documentation.",
                    "url": "LINK HERE"
                },
                "parameters": [
                    {
                        "description": "",
                        "in": "header",
                        "name": "Accept"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Program name and version",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "programName": {
                                            "type": "string",
                                            "example": "norderney"
                                        },
                                        "programVersion": {
                                            "type": "string",
                                            "example": "alpha-1-gbfed333-dirty"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            }
        },

        "/objects": {
            "get": {
                "summary": "Returns a list of all simulation data on the server.",
                "description": "Returns a listing of all the simulation data that is available in the directory, that the server is serving from.",
                "tags": [
                    ""
                ],
                "parameters": [
                    {
                        "description": "",
                        "in": "header",
                        "name": "Accept"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "A list with the simulation data that is available on the server.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/availableObjects"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            }
        },

        "/scenes": {

            "get": {
                "summary": "Returns a list of all active scenes on the server.",
                "description": "Get a listing of all scene_hashes (that is: a listing of all scenes) available.",
                "tags": [
                    ""
                ],
                "parameters": [
                    {
                        "description": "",
                        "in": "header",
                        "name": "Accept"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "An objectslist object",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/activeScenes"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            },

            "post": {
                "summary": "Create a new scene.",
                "description": "Create a new scene with a list of objects that are used for initialization.",
                "tags": [
                    ""
                ],
                "parameters": [
                    {
                        "description": "",
                        "in": "header",
                        "name": "Accept"
                    }
                ],
                "requestBody": {
                    "description": "A list of objects to be added to the new scene. Duplicates are allowed.",
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "addObjects": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "example": "object a"
                                        },
                                        "minItems": "1"
                                    }
                                }
                            }
                        }
                    },
                    "required": "true"
                },
                "responses": {
                    "200": {
                        "description": "New scene created. Complete success, all objects could be added. The response contains a list with objects that were added to the simulation.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/addObjectsSuccess"
                                }
                            }
                        }
                    },
                    "206": {
                        "description": "New scene created. Partial success, some objects could not be added. The response contains a list with added objects and a list with objects, that could not be added.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/addObjectsPartial"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Could not create new scene - none of the requested objects exist.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "properties": {
                                                "errorCode": {
                                                    "type": "string",
                                                    "example": "404"
                                                },
                                                "errorMessage": {
                                                    "type": "string",
                                                    "example": "A new scene could not be created, no objects found."
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            },

            "delete": {
                "summary": "Delete a scene.",
                "tags": [
                    ""
                ],
                "parameters": [
                    {
                        "description": "",
                        "in": "header",
                        "name": "Accept"
                    }
                ],
                "requestBody": {
                    "description": "A list of scenes to delete.",
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "deleteScenes": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "example": "21dfb0dbf1034ff897aebfa0b8058a51e4a23f7a"
                                        },
                                        "minItems": "1"
                                    }
                                }
                            }
                        }
                    },
                    "required": "true"
                },
                "responses": {
                    "200": {
                        "description": "Complete success. All scenes deleted. The response contains a list with the scenes that were deleted.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "deleteScenesSuccess": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "21dfb0dbf1034ff897aebfa0b8058a51e4a23f7a"
                                            },
                                            "minItems": "1"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "206": {
                        "description": "Partial success. Some scenes were deleted but not every one. The response contains a list with the deleted scenes and a list with the scenes, that could not be deleted.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "deleteScenesSuccess": {
                                            "description": "A list of scenes that were deleted.",
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "21dfb0dbf1034ff897aebfa0b8058a51e4a23f7a"
                                            },
                                            "minItems": "1"
                                        },
                                        "deleteScenesFail": {
                                            "description": "A list of scenes that could NOT be deleted.",
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "21dfb0dbf1034ff897aebfa0b8058a5"
                                            },
                                            "minItems": "1"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "No scenes were deleted. None of the scenes requested do exist.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "properties": {
                                                "errorCode": {
                                                    "type": "string",
                                                    "example": "404"
                                                },
                                                "errorMessage": {
                                                    "type": "string",
                                                    "example": "Scenes were not found."
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            }
        },

        "/scenes/{scene_hash}": {

            "get": {
                "summary": "Get a listing of all objects in this scene.",
                "tags": [
                    ""
                ],
                "parameters": [
                    {
                        "description": "The scene for which we want to get all objects.",
                        "in": "path",
                        "name": "scene_hash",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "A list of all the objects in this scene.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "objectList": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "$ref": "#/components/schemas/sceneObject"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            },

            "post": {
                "summary": "Add one or more object(s) to the scene.",
                "tags": [
                    ""
                ],
                "parameters": [
                    {
                        "description": "The scene to which we want to add objects.",
                        "in": "path",
                        "name": "scene_hash",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "description": "A list of objects to add to the scene.",
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "addObjects": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "example": "object d"
                                        },
                                        "minItems": "1"
                                    }
                                }
                            }
                        }
                    },
                    "required": "true"
                },
                "responses": {
                    "200": {
                        "description": "Complete success, all objects could be added. The response contains a list with objects that were added to the scene.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/addObjectsSuccess"
                                }
                            }
                        }
                    },
                    "206": {
                        "description": "New scene created. Partial success, some objects could not be added. The response contains a list with added objects and a list with objects, that could not be added.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/addObjectsPartial"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Could not create new scene - none of the requested objects exist.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "properties": {
                                                "errorCode": {
                                                    "type": "string",
                                                    "example": "404"
                                                },
                                                "errorMessage": {
                                                    "type": "string",
                                                    "example": "A new scene could not be created, no objects found."
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            }
        },

        "/scenes/{scene_hash}/{object_hash}": {

            "options": {
                "summary": "Return information about the methods that are exposed.",
                "description": "Return information about the methods that are exposed. That means `/orientation`, `/timesteps`, `/fields` and `/view`. See about the implementation in cherrypy about this...",
                "tags": [
                    "verify"
                ],

            },

            "get": {
                "summary": "Get all the information about this object.",
                "description": "Returns information about this object. Like available timesteps, simulation subsets (temp, etc), orientation, ... unclear what exactly, so WIP.",
                "tags": [
                    ""
                ],
                "parameters": [
                    {
                        "description": "The scene containing the object.",
                        "in": "path",
                        "name": "scene_hash",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "description": "The object.",
                        "in": "path",
                        "name": "object_hash",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The information about the object.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "$ref": "#/components/schemas/sceneObject"
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "summary": "Delete this object from the scene.",
                "tags": [
                    ""
                ],
                                "parameters": [
                    {
                        "description": "The scene containing the object.",
                        "in": "path",
                        "name": "scene_hash",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "description": "The object.",
                        "in": "path",
                        "name": "object_hash",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "description": "A list of objects to delete from the scene.",
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "deleteObjects": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "example": "21dfb0dbf1034ff897aebfa0b8058a51e4a23f7a"
                                        },
                                        "minItems": "1"
                                    }
                                }
                            }
                        }
                    },
                    "required": "true"
                },
                "responses": {
                    "200": {
                        "description": "Complete success. Returns a list with the hashes of the objects that were deleted from the scene.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "deleteObjectsSuccess": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "21dfb0dbf1034ff897aebfa0b8058a51e4a23f7a"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "206": {
                        "description": "Partial success. Returns a list with the hashes of the objects that were deleted from the scene and a list with the hashes that could not be deleted.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "deleteObjectsSuccess": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "21dfb0dbf1034ff897aebfa0b8058a51e4a23f7a"
                                            }
                                        },
                                        "deleteObjectsFail": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "21dfb0dbf1034ff897ef80a"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "No success. Returns a list with the objects that could not be deleted and an error message.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "deleteObjectsFail": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "21dfb0dbf1034ff897ef80a"
                                            }
                                        },
                                        "error": {
                                            "type": "object",
                                            "properties": {
                                                "message": {
                                                    "type": "string",
                                                    "example": "The objects could not be removed from the scene."
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/defaultError"
                                }
                            }
                        }
                    }
                }
            }
        },

        "/scenes/{scene_hash}/{object_hash}/orientation": {
            "get": {
                "summary": "Get the orientation of this object.",
                "tags": [
                    ""
                ]
            },
            "put": {
                "summary": "Alter the orientation of this object.",
                "tags": [
                    ""
                ]
            }
        },

        "/scenes/{scene_hash}/{object_hash}/timesteps": {
            "get": {
                "summary": "Returns the current and selected timestep(s).",
                "description": "Returns the currently selected and available timestep(s) of this object.",
                "tags": [
                    ""
                ]
            },
            "put": {
                "summary": "Sets the current timestep to one that is available.",
                "tags": [
                    ""
                ]
            }
        },

        "/scenes/{scene_hash}/{object_hash}/fields": {
            "get": {
                "summary": "Returns the current and displayable field(s).",
                "description": "Returns the currently displayed field and the displayable fields (temperature, etc) of this object.",
                "tags": [
                    ""
                ]
            },
            "put": {
                "summary": "Sets the displayed field to one that is available.",
                "tags": [
                    ""
                ]
            }
        },

        "/scenes/{scene_hash}/{object_hash}/view": {
            "get": {
                "summary": "Returns the current and displayable view.",
                "description": "Returns the currently displayed view and the displayable view (how much we can see) of this object.",
                "tags": [
                    ""
                ]
            },
            "put": {
                "summary": "Sets the displayed view.",
                "tags": [
                    ""
                ]
            }
        }
    },

    "components": {
        "schemas": {

            "availableObjects": {
                "description": "A list with objects.",
                "required": [
                    "objectList"
                ],
                "properties": {
                    "objectList": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "example": ["numsim.napf.tiefziehversuch", "object a", "numsim.singlepass.s355j2+n"]
                    }
                }
            },

            "activeScenes": {
                "description": "A list with active scenes on the server.",
                "required": [
                    "sceneList"
                ],
                "properties": {
                    "sceneList": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "example": [
                            "babf090679cf7b50f1a52138dadc9ea50b6b0700",
                            "77d8548a5def0e7a410259296eb24776ae19047c",
                            "4c0e21b939da38778e76a03e284bb5ed92e6fdf7"
                        ]
                    }
                }
            },

            "objectOrientation": {
                "description": "The orientation of an object",
                "required": [
                    "objectMeta",
                    "objectOrientation"
                ],
                "properties": {
                    "objectMeta": {
                        "type": "object",
                        "$ref": "#/components/schemas/sceneObject"
                    },
                    "objectOrientation": {
                        "type": "array",
                        "items": {
                            "type": "number",
                            "format": "double",
                            "example": "0.897123"
                        },
                        "minItems": "16",
                        "maxItems": "16"
                    }
                }
            },

            "defaultError": {
                "description": "A default error message and code.",
                "properties": {
                    "error": {
                        "properties": {
                            "errorCode": {
                                "type": "string",
                                "example": "An example default error code."
                            },
                            "errorMessage": {
                                "type": "string",
                                "example": "An example default error message."
                            }
                        }
                    }
                }
            },

            "addObjectsSuccess": {
                "description": "The response on successfully creating a new scene.",
                "type": "object",
                "properties": {
                    "href": {
                        "description": "A link to the new scene.",
                        "type": "string",
                        "example": "/scenes/47e9f7fc6d1522c552fffaf1803a0e1822620024"
                    },
                    "addObjectsSuccess": {
                        "description": "An array with JSON objects containing information about objects.",
                        "type": "array",
                        "items": {
                            "type": "object",
                            "$ref": "#/components/schemas/sceneObject"
                        }
                    }
                }
            },

            "addObjectsPartial": {
                "description": "The response on partially creating a new scene.",
                "type": "object",
                "properties": {
                    "href": {
                        "description": "A link to the scene.",
                        "type": "string",
                        "example": "/scenes/47e9f7fc6d1522c552fffaf1803a0e1822620024"
                    },
                    "addObjectsSuccess": {
                        "description": "An array with JSON objects containing information about objects.",
                        "type": "array",
                        "items": {
                            "type": "object",
                            "$ref": "#/components/schemas/sceneObject"
                        }
                    },
                    "addObjectsFail": {
                        "description": "An array objects that could not be added to the scene.",
                        "type": "array",
                        "items": {
                            "type": "string",
                        },
                        "example": ["object z", "object k"]
                    }
                }
            },

            "sceneObject": {
                "description": "The name, unique identifier and alias of an object that is loaded into a scene.",
                "required": [
                    "objectName",
                    "objectHash"
                ],
                "properties": {
                    "objectName": {
                        "description": "The folder name as present on the server.",
                        "type": "string",
                        "example": "numsim.napf.tiefziehversuch"
                    },
                    "objectHash": {
                        "description": "A unique identifier assigned to the object on the time of adding it to the scene.",
                        "type": "string",
                        "example": "47e9f7fc6d1522c552fffaf1803a0e1822620024"
                    },
                    "objectAlias": {
                        "description": "An alias for the object to be able to differentiate two identical objects in a scene.",
                        "type": "string",
                        "example": "alias for numsim.napf.tiefziehversuch"
                    },
                    "objectHref": {
                        "description": "A link to the object in the scene.",
                        "type": "string",
                        "example": "/scenes/21dfb0dbf1034ff897aebfa0b8058a51e4a23f7a/47e9f7fc6d1522c552fffaf1803a0e182262002"
                    }
                }
            }

        }
    }
}
